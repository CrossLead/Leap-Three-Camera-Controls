
<html>
  <head>
    <script src="lib/leap.min.js">                              </script>

    <script src="lib/three.js">                                 </script>
    <script src="lib/stats.min.js">                             </script>
    <script src="lib/dat.gui.min.js">                           </script>
    
    <script src="lib/LeapPaddleControls.js">                    </script>
    <script src="lib/LeapSpringControls.js">                    </script>
    <script src="lib/LeapTrackballControls.js">                 </script>
    <script src="lib/LeapTwoHandControls.js">                 </script>
    
    <style>

      body {

        font-family:"GeoSans";
        overflow:hidden;

      }

      #controls{

        position:absolute;

        top:0px;
        left:0px;
        color:#000;
        z-index:1;

        font-size: 20px;

        background:rgba( 255, 255, 255 , .5 );
        border: 1px solid black;

      }

      .control{

        padding: 10px;
        border-left: 1px solid black;
        border-right: 1px solid black;

      }

      .control:hover{
        background:rgba( 255 , 255 , 255 , .9 );
        //border: 1px solid black;
      }


      #descriptions{

        position: fixed;
        width:634px;
        top:34px;
        left:0px;
        background:rgba( 255 , 255 , 255 , .9 );

      }

      .description{

        padding:50px;

      }

      .active{
        background:rgba( 255 , 255 , 255 , .9 );
      }

      #container{

        background:#000;
        position:absolute;
        top:0px;
        left:0px;

      }

      #stats{

        position:absolute;
        bottom:0px;
        right:0px;

      }


      #switch{

        position:absolute;

        top:0px;
        left:0px;
        color:#fff;
        z-index:1;

      }

      @font-face {
        font-family: "GeoSans";
        src: url("lib/GeosansLight.ttf");
      }

    </style>

  </head>

  <body>

    <div id = "controls" >
      <a class="control" onclick="switchControls('paddle'   , this )">Leap Paddle Controls</a>
      <a class="control" onclick="switchControls('trackball', this )">Leap Trackball Controls</a>
      <a class="control" onclick="switchControls('twoHand'  , this )">Leap Two Hand Controls</a>
      <a class="control" onclick="switchControls('spring'   , this )">Leap Spring Controls</a>
    </div>

    <div id="descriptions">
      <div class="description">
        <h1> Paddle Controls </h1>
        <p> 
          Paddle Controls are a type of control that allows the user to 'paddle' through a scene.
          If a user 'slices' through the field, the camera will not move, but if they 'paddle' 
          through it, it will. The parameters are as follows:
          <ul>
            <li></li>
          </ul>
        </p>
      </div>
      <div class="description">
        <h1> Trackball Controls </h1>
        <p>
          Trackball Controls enable the user to use the scene like a giant ball that they
          push around with a single hand. Although there is a 'zoom' part of this controls,
          currently it is based more on rotation than it is is translation. The parameters 
          as follows:
          <ul>
            <li></li>
          </ul>
        </p>
      </div>
      <div class="description">
        <h1> Two Hand Controls </h1>
        <p>
          Two Hand Controls let a user move around the scene by pinching. Once engaged in a 
          pinch the user can simply move their hand to move the scene, or additionally begin
          pinching with the second hand to rotate, scale, or translate the scene. The
          parameters are as follows:
          <ul>
            <li></li>
          </ul>
        </p>
      </div>
      <div class="description">
        <h1> Spring Controls </h1>
        <p>
          Spring Controls use physics to create a interaction method. By pinching, the user
          places an 'anchor' at the position they pinched. A spring is connected between the 
          camera and the anchor, so it gets pulled to a stable position a certain distance 
          away from the anchor. Users can also keep their hand pinched to smoothly move / look
          around the scene. The parameters are as follows:
          <ul>
            <li></li>
          </ul>
        </p>
      </div>





    <div id="container"></div>


    <script>


      // SCENE SIZE
      var SS = 1000;
      
      var clock, camera, scene, world;
      var container, renderer, stats;
      var activeControls , cameraController;

      var GUI;

      var controls = [];
      var controlLinks = document.getElementsByClassName( 'control' );
      console.log( controlLinks );
      var activeControl = 0;

      // Geometry for particle system
      var geometery , material;

      

      init();

      function switchControls( control ,  domElement ){

        console.log( this );
        console.log( event );

        if( control == 'paddle' ){

          activeControl = 0;

        }else if( control == 'trackball' ){

          activeControl = 1;

        }else if( control == 'twoHand' ){

          activeControl = 2;

        }else if( control == 'spring' ){

          activeControl = 3;

        }

        domElement.classList.add( 'active' );
        //domElement.style.border= "1px solid black";
        for( var i = 0; i < controlLinks.length; i++ ){

          var element = controlLinks[i];
          if( element !=  domElement ){

            element.classList.remove( 'active' );

          }else{

            console.log( 'skipped' );

          }

        }
           console.log('switchControls', activeControl)
      }


      function init(){

 
        
        /*

          SETTING UP SCENE

        */

        clock = new THREE.Clock();

        scene = new THREE.Scene();
        
        world = new THREE.Object3D();


        camera = new THREE.PerspectiveCamera( 50 , window.innerWidth / window.innerHeight , SS / 1000 , SS * 20 );
        camera.position.z = SS;
        scene.add(world);


        /*

          SETTING UP CONTROLS

        */
        leapController = new Leap.Controller({enableGestures:true});

        var c = camera;
        var l = leapController
        
        // Create our Controls
        var paddleControls  = new THREE.LeapPaddleControls( c , l );
        controls.push( paddleControls );

         //camera.matrixAutoUpdate = false;

        var trackballControls = new THREE.LeapTrackballControls( c , l );
        controls.push( trackballControls );

        var fistControls = new THREE.LeapTwoHandControls( c , l );
        controls.push( fistControls );

        // the Spring controls require a scene to add the markers to!
        var springControls  = new THREE.LeapSpringControls( c , l , scene );
        controls.push( springControls );



        /*

          SETTING UP DAT GUI

        */

        var GUI_PARAMS = {};
        GUI_PARAMS.resetCamera = function(){

          springControls.target.position = new THREE.Vector3(0,0,0);
          camera.position = new THREE.Vector3();
          camera.rotation = new THREE.Euler();
          camera.lookAt( new THREE.Vector3( 0 , 0 , 0 ) );

        }

        gui = new dat.GUI();

        gui.add( GUI_PARAMS , 'resetCamera' );

        gui.paddleControls = gui.addFolder( 'Paddle Controls' );
        gui.trackballControls = gui.addFolder( 'Trackball Controls' );
        gui.twoHandControls = gui.addFolder( 'Two Hand Controls' );
        gui.springControls = gui.addFolder( 'Spring Controls' );


        gui.paddleControls.add( paddleControls , 'weakDampening' , 0.8 , 1);
        gui.paddleControls.add( paddleControls , 'strongDampening', 0.8 , 1 );
        gui.paddleControls.add( paddleControls , 'directionStrength' , 0 , 6 );
        gui.paddleControls.add( paddleControls , 'power' , 0 , 6);
        gui.paddleControls.add( paddleControls , 'divisionFactor' , 0 , 5000 );
        gui.paddleControls.add( paddleControls , 'maxVelocity' , 0 , 100 );



        gui.trackballControls.add( trackballControls , 'rotationSpeed' , 0.0 , 100 );
        gui.trackballControls.add( trackballControls , 'rotationDampening' , 0.8 , 1);
        gui.trackballControls.add( trackballControls , 'zoomDampening' , 0.8 , 1 );
        gui.trackballControls.add( trackballControls , 'minZoom' , 0 , 4000 );
        gui.trackballControls.add( trackballControls , 'maxZoom' , 0 , 4000 );


        gui.springControls.add( springControls , 'weakDampening' , 0.8 , 1 );
        gui.springControls.add( springControls , 'strongDampening' , 0.8 , 1 );
        gui.springControls.add( springControls , 'size' , 0 , 1000 );
        gui.springControls.add( springControls , 'springConstant' , 0 , 50 );
        gui.springControls.add( springControls , 'staticLength' , 0 , 1000 );
        gui.springControls.add( springControls , 'mass' , 0 , 5000 );
        gui.springControls.add( springControls , 'anchorToTarget' , 0 , 100 );




        /*

          SETTING UP STAR FIELD

        */

        for( var i = 0; i < 5; i ++ ){

          geometry = new THREE.Geometry();

          for( var j = 0 ; j < 1000; j++ ){

            var vert = new THREE.Vector3();

            vert.x = ( Math.random() - .5 ) * 10 * SS;
            vert.y = ( Math.random() - .5 ) * 10 * SS;
            vert.z = ( Math.random() - .5 ) * 10 * SS;

            geometry.vertices.push( vert );

          }

          var color = new THREE.Color();
          color.r = i / 5 ;
          color.g = ( 5 - i ) / 5 ;
          color.b = 1;
          
          var material = new THREE.ParticleSystemMaterial({
            size:60, 
            color:color.getHex()
          });

          var particles = new THREE.ParticleSystem( geometry , material );

          world.add(particles);
        }



        /*

          SETTING UP RENDERER

        */
        container = document.getElementById( 'container' );
        
        renderer = new THREE.WebGLRenderer( { antialias: true, clearColor:0x000000 } );
        renderer.setSize( window.innerWidth, window.innerHeight );

        container.appendChild( renderer.domElement );


        /*

          SETTING UP STATS

        */
        stats = new Stats();
        container.appendChild( stats.domElement );


        // adding an event listener to change our event window
        window.addEventListener( 'resize', onWindowResize, false );

        // Get things rolling
        BEGIN();

      }


      function BEGIN(){

        //Add things to do when the app first starts here

        animationLoop();
        leapController.connect();

      }

      function animate(){

        stats.update();
        controls[activeControl].update();
        renderer.render( scene , camera );

      }   


      function animationLoop() {
        animate();
        requestId = window.requestAnimationFrame(animationLoop);

      }

      
      function stopAnimationLoop() {
        
        if (requestId) {
          cancelAnimationFrame(requestId);
          requestId = undefined;
        }

      }

      
      function onWindowResize() {

        windowHalfX = window.innerWidth / 2;
        windowHalfY = window.innerHeight / 2;

        camera.aspect = window.innerWidth / window.innerHeight;
        camera.updateProjectionMatrix();

        renderer.setSize( window.innerWidth, window.innerHeight );

      }



    </script>

  </body>
</html>
